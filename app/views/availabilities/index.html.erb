<%= link_to 'New Availability', new_availability_path, class: 'btn btn-primary' %>

<h1>All Availabilities</h1>

<% @availabilities.each do |availability| %>

<div class="booyah-box">

  <div class="row">
    <div class="col-md-6">
      <%= image_tag availability.user.pic, :class => 'img-responsive' %>
    </div>
    <div class="col-md-6">
      <strong><p><%= "#{availability.user.email}'s availability" %></strong>
      <p>Available from: <%= availability.available_from %></p>
      <p>Available to: <%= availability.available_to %></p>
      <p>Location: <%= availability.location %></p>
      <p>Details: <%= availability.comment %></p>
      <% if !user_signed_in? # only show/use this button if no user signed in%>
      <%= simple_form_for Request.new, url: requests_path(current_user, 
  request: {
    user_id: current_user, 
    requested_of_user_id: availability.user, 
    status: 'pending'}
  ), method: :post do |f| %>
      <%= f.button :submit, 'Have this person walk my pup!', class: 'btn btn-success btn-lg'%>
      <% end %>
      <% end %>
      <% if availability.user == current_user %>  
      <%= link_to 'Destroy', availability, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger' %>
      <% end %>
    </div>
  </div> <!-- row -->

  <br>

  <% if user_signed_in? %>
  <strong><p><%= "#{current_user.email}'s outstanding jobs" %></p></strong>
  <% current_user.jobs.each do |job| %>
  <div class="row">
    <div class="col-md-10">
      <strong>Name:</strong><%= job.pup.pup_name %>
      <strong>Drop off:</strong><%= job.drop_off_time.to_formatted_s(:long_ordinal) %>
      <strong>Place:</strong><%= job.drop_off_location %>
      <strong>Pick up:</strong><%= job.pick_up_time.to_formatted_s(:long_ordinal) %>
      <strong>Place:</strong><%= job.pick_up_location %>
    </div>
    <div class="col-md-2">
      <%= simple_form_for Request.new, url: requests_path(current_user, request: {
  user_id: current_user,
  requested_of_user_id: availability.user, 
  job_id: job, 
  availability_id: availability, 
  status: 'pending'}), method: :post do |f| %>
      <%= f.button :submit, 'Ask!', class: 'btn btn-success btn-xs'%>
      <% end %>
    </div>
  </div>
  <% end %>
  <% end %>
</div> <!--booyah-box-->

<br>

<% end %>
